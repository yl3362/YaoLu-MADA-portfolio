---
title: "dataanalysis_exercise"
editor: visual
---

The data was found at https://data.cdc.gov/NCHS/Weekly-Counts-of-Deaths-by-Jurisdiction-and-Age/y5bj-9g5w

This data include 11 variables. This data set describes a time series data for each state by age.

```{r}
library(ggplot2)
library(here)

data_location1 <- here::here("rawdata","Weekly_Counts_of_Deaths_by_Jurisdiction_and_Age.csv")

data1 <- read.csv(data_location1)

p <- ggplot(data = data1[which(data1$Jurisdiction=="Georgia"&data1$Type=='Predicted (weighted)'),], aes(x = Week, y = Number.of.Deaths, group = Age.Group,color=Age.Group))
p + geom_line()+ggtitle("number of death(weighted) in GA") +  xlab("week") + ylab("death")
```
Here we can see that most death happened at aged people. Few young people die. Then we check the 'Week' variables. We can see that The week is the number of week in each year. Then we want to see a time series week.

```{r}
#redefine the week variable
table(data1$Year[which(data1$Week==53)])
table(data1$Year[which(data1$Week==52)])

data1$newweek <- NA
data1$newweek[which(data1$Year==2015)] <- data1$Week[which(data1$Year==2015)]
data1$newweek[which(data1$Year==2016)] <- data1$Week[which(data1$Year==2016)]+52
data1$newweek[which(data1$Year==2017)] <- data1$Week[which(data1$Year==2017)]+52*2
data1$newweek[which(data1$Year==2018)] <- data1$Week[which(data1$Year==2018)]+52*3
data1$newweek[which(data1$Year==2019)] <- data1$Week[which(data1$Year==2019)]+52*4
data1$newweek[which(data1$Year==2020)] <- data1$Week[which(data1$Year==2020)]+52*5
data1$newweek[which(data1$Year==2021)] <- data1$Week[which(data1$Year==2021)]+52*6+1
data1$newweek[which(data1$Year==2022)] <- data1$Week[which(data1$Year==2022)]+52*7+1


p <- ggplot(data = data1[which(data1$Jurisdiction=="Georgia"&data1$Type=='Predicted (weighted)'),], aes(x = newweek, y = Number.of.Deaths, group = Age.Group,color=Age.Group))
p + geom_line()+ggtitle("number of death(weighted) in GA") +  xlab("week") + ylab("death")

```

We can see that there is a peak at around 350 weeks.
Here we can see that most death happened at aged people. Few young people die.

We can apply time series analysis. Such as using ACF, PACF to find best ARIMA model.


```{r}
table_file1 = here("processdata","resulttable1.rds")
saveRDS(data1, file = table_file1)
```

```{r}
table(data1$Age.Group)
data1$Age.Group[which(data1$Age.Group=='Under 25 years')] <- '24 or younger'
```

```{r}
boxplot(Number.of.Deaths~Age.Group,data=data1[which(data1$Jurisdiction=="Georgia"&data1$Type=='Predicted (weighted)'),], main="number of death in GA",        xlab="age", ylab="death")
```
---
