[
  {
    "objectID": "aboutme.html",
    "href": "aboutme.html",
    "title": "About me",
    "section": "",
    "text": "#Background\nMy name is Yao Lu. I am a second year PhD student concentrating in data analysis and modeling. I completed my undergraduate education at Qingdao University, majoy in math and minor in finance. I completed master education at University of Dayton with math major focusing on statistics.\n#Goals for MADA\nI have learned some theoretical statistical inference. The most parts I’d like to learn is how to transform the theoretical knowledge into application about solving the problem in real world. And how to present to others in a simple and clear way.\n#Research interests\nMy primary interest is in infectious disease, especially influenza. Recently I am exploring the ferret vaccination data.\n#fun fact\nI lived in Qingdao(China) for more than twenty years, which is a beautiful costal city. There are many delicious seafood there. Qingdao is a city which is surrounded by mountains and sea. Before I moved to Gerogia, I lived two years in Ohio which has a colder winter, and Ohio has thick snow there in winter.\n#Experience\nBefore I came to UGA, I had math/statistics backgrounds. I have used R/SAS for solving and displaying statistics problems. I have used Matlab for solving PDF problems. I have used Latex for display statistics problems and formulas."
  },
  {
    "objectID": "coding_exercise.html",
    "href": "coding_exercise.html",
    "title": "R Coding Exercise",
    "section": "",
    "text": "Placeholder file for the future R coding exercise.\n\n#load dslabs package\nlibrary(\"dslabs\")\n\nWarning: package 'dslabs' was built under R version 4.2.2\n\nlibrary('tidyverse')\n\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n\n\nWarning: package 'tibble' was built under R version 4.2.2\n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\n#look at help file for gapminder data\nhelp(gapminder)\n\nstarting httpd help server ... done\n\n#get an overview of data structure\nstr(gapminder)\n\n'data.frame':   10545 obs. of  9 variables:\n $ country         : Factor w/ 185 levels \"Albania\",\"Algeria\",..: 1 2 3 4 5 6 7 8 9 10 ...\n $ year            : int  1960 1960 1960 1960 1960 1960 1960 1960 1960 1960 ...\n $ infant_mortality: num  115.4 148.2 208 NA 59.9 ...\n $ life_expectancy : num  62.9 47.5 36 63 65.4 ...\n $ fertility       : num  6.19 7.65 7.32 4.43 3.11 4.55 4.82 3.45 2.7 5.57 ...\n $ population      : num  1636054 11124892 5270844 54681 20619075 ...\n $ gdp             : num  NA 1.38e+10 NA NA 1.08e+11 ...\n $ continent       : Factor w/ 5 levels \"Africa\",\"Americas\",..: 4 1 1 2 2 3 2 5 4 3 ...\n $ region          : Factor w/ 22 levels \"Australia and New Zealand\",..: 19 11 10 2 15 21 2 1 22 21 ...\n\n#get a summary of data\nsummary(gapminder)\n\n                country           year      infant_mortality life_expectancy\n Albania            :   57   Min.   :1960   Min.   :  1.50   Min.   :13.20  \n Algeria            :   57   1st Qu.:1974   1st Qu.: 16.00   1st Qu.:57.50  \n Angola             :   57   Median :1988   Median : 41.50   Median :67.54  \n Antigua and Barbuda:   57   Mean   :1988   Mean   : 55.31   Mean   :64.81  \n Argentina          :   57   3rd Qu.:2002   3rd Qu.: 85.10   3rd Qu.:73.00  \n Armenia            :   57   Max.   :2016   Max.   :276.90   Max.   :83.90  \n (Other)            :10203                  NA's   :1453                    \n   fertility       population             gdp               continent   \n Min.   :0.840   Min.   :3.124e+04   Min.   :4.040e+07   Africa  :2907  \n 1st Qu.:2.200   1st Qu.:1.333e+06   1st Qu.:1.846e+09   Americas:2052  \n Median :3.750   Median :5.009e+06   Median :7.794e+09   Asia    :2679  \n Mean   :4.084   Mean   :2.701e+07   Mean   :1.480e+11   Europe  :2223  \n 3rd Qu.:6.000   3rd Qu.:1.523e+07   3rd Qu.:5.540e+10   Oceania : 684  \n Max.   :9.220   Max.   :1.376e+09   Max.   :1.174e+13                  \n NA's   :187     NA's   :185         NA's   :2972                       \n             region    \n Western Asia   :1026  \n Eastern Africa : 912  \n Western Africa : 912  \n Caribbean      : 741  \n South America  : 684  \n Southern Europe: 684  \n (Other)        :5586  \n\n#determine the type of object gapminder is\nclass(gapminder)\n\n[1] \"data.frame\"\n\n#select only africa\nafricadata <- gapminder[which(gapminder$continent=='Africa'),]\n#get an overview of data structure\nstr(africadata)\n\n'data.frame':   2907 obs. of  9 variables:\n $ country         : Factor w/ 185 levels \"Albania\",\"Algeria\",..: 2 3 18 22 26 27 29 31 32 33 ...\n $ year            : int  1960 1960 1960 1960 1960 1960 1960 1960 1960 1960 ...\n $ infant_mortality: num  148 208 187 116 161 ...\n $ life_expectancy : num  47.5 36 38.3 50.3 35.2 ...\n $ fertility       : num  7.65 7.32 6.28 6.62 6.29 6.95 5.65 6.89 5.84 6.25 ...\n $ population      : num  11124892 5270844 2431620 524029 4829291 ...\n $ gdp             : num  1.38e+10 NA 6.22e+08 1.24e+08 5.97e+08 ...\n $ continent       : Factor w/ 5 levels \"Africa\",\"Americas\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ region          : Factor w/ 22 levels \"Australia and New Zealand\",..: 11 10 20 17 20 5 10 20 10 10 ...\n\n#get a summary of data\nsummary(africadata)\n\n         country          year      infant_mortality life_expectancy\n Algeria     :  57   Min.   :1960   Min.   : 11.40   Min.   :13.20  \n Angola      :  57   1st Qu.:1974   1st Qu.: 62.20   1st Qu.:48.23  \n Benin       :  57   Median :1988   Median : 93.40   Median :53.98  \n Botswana    :  57   Mean   :1988   Mean   : 95.12   Mean   :54.38  \n Burkina Faso:  57   3rd Qu.:2002   3rd Qu.:124.70   3rd Qu.:60.10  \n Burundi     :  57   Max.   :2016   Max.   :237.40   Max.   :77.60  \n (Other)     :2565                  NA's   :226                     \n   fertility       population             gdp               continent   \n Min.   :1.500   Min.   :    41538   Min.   :4.659e+07   Africa  :2907  \n 1st Qu.:5.160   1st Qu.:  1605232   1st Qu.:8.373e+08   Americas:   0  \n Median :6.160   Median :  5570982   Median :2.448e+09   Asia    :   0  \n Mean   :5.851   Mean   : 12235961   Mean   :9.346e+09   Europe  :   0  \n 3rd Qu.:6.860   3rd Qu.: 13888152   3rd Qu.:6.552e+09   Oceania :   0  \n Max.   :8.450   Max.   :182201962   Max.   :1.935e+11                  \n NA's   :51      NA's   :51          NA's   :637                        \n                       region   \n Eastern Africa           :912  \n Western Africa           :912  \n Middle Africa            :456  \n Northern Africa          :342  \n Southern Africa          :285  \n Australia and New Zealand:  0  \n (Other)                  :  0  \n\n#infant_mortality and life_expectancy\nmoex <- africadata %>% select(c('infant_mortality','life_expectancy'))\n#population and life_expectancy\npoex <- africadata %>% select(c('population','life_expectancy'))\n#get an overview of data structure\nstr(moex)\n\n'data.frame':   2907 obs. of  2 variables:\n $ infant_mortality: num  148 208 187 116 161 ...\n $ life_expectancy : num  47.5 36 38.3 50.3 35.2 ...\n\nstr(poex)\n\n'data.frame':   2907 obs. of  2 variables:\n $ population     : num  11124892 5270844 2431620 524029 4829291 ...\n $ life_expectancy: num  47.5 36 38.3 50.3 35.2 ...\n\n#get a summary of data\nsummary(moex)\n\n infant_mortality life_expectancy\n Min.   : 11.40   Min.   :13.20  \n 1st Qu.: 62.20   1st Qu.:48.23  \n Median : 93.40   Median :53.98  \n Mean   : 95.12   Mean   :54.38  \n 3rd Qu.:124.70   3rd Qu.:60.10  \n Max.   :237.40   Max.   :77.60  \n NA's   :226                     \n\nsummary(poex)\n\n   population        life_expectancy\n Min.   :    41538   Min.   :13.20  \n 1st Qu.:  1605232   1st Qu.:48.23  \n Median :  5570982   Median :53.98  \n Mean   : 12235961   Mean   :54.38  \n 3rd Qu.: 13888152   3rd Qu.:60.10  \n Max.   :182201962   Max.   :77.60  \n NA's   :51                         \n\n#scatter plot infant mortality VS life expectancy\nplot(moex$infant_mortality,moex$life_expectancy, main=\"infant mortality VS life expectancy\", xlab=\"infant mortality\", ylab=\"life expectancy\", pch=19)\n\n\n\n\n\n#scatter plot population size VS life expectancy\nplot(poex$population,poex$life_expectancy, main=\"population size VS life expectancy\", xlab=\"population size\", ylab=\"life expectancy\", pch=19,log='x')\n\n\n\n\n\n#the year which infant_mortality is NA\nnamor <-africadata$year[which(is.na(africadata$infant_mortality))]\ntable(namor)\n\nnamor\n1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974 1975 \n  10   17   16   16   15   14   13   11   11    7    5    6    6    6    5    5 \n1976 1977 1978 1979 1980 1981 2016 \n   3    3    2    2    1    1   51 \n\n\n\n#2000 year\nafri2000 <- africadata[which(africadata$year==2000),]\nstr(afri2000)\n\n'data.frame':   51 obs. of  9 variables:\n $ country         : Factor w/ 185 levels \"Albania\",\"Algeria\",..: 2 3 18 22 26 27 29 31 32 33 ...\n $ year            : int  2000 2000 2000 2000 2000 2000 2000 2000 2000 2000 ...\n $ infant_mortality: num  33.9 128.3 89.3 52.4 96.2 ...\n $ life_expectancy : num  73.3 52.3 57.2 47.6 52.6 46.7 54.3 68.4 45.3 51.5 ...\n $ fertility       : num  2.51 6.84 5.98 3.41 6.59 7.06 5.62 3.7 5.45 7.35 ...\n $ population      : num  31183658 15058638 6949366 1736579 11607944 ...\n $ gdp             : num  5.48e+10 9.13e+09 2.25e+09 5.63e+09 2.61e+09 ...\n $ continent       : Factor w/ 5 levels \"Africa\",\"Americas\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ region          : Factor w/ 22 levels \"Australia and New Zealand\",..: 11 10 20 17 20 5 10 20 10 10 ...\n\nsummary(afri2000)\n\n         country        year      infant_mortality life_expectancy\n Algeria     : 1   Min.   :2000   Min.   : 12.30   Min.   :37.60  \n Angola      : 1   1st Qu.:2000   1st Qu.: 60.80   1st Qu.:51.75  \n Benin       : 1   Median :2000   Median : 80.30   Median :54.30  \n Botswana    : 1   Mean   :2000   Mean   : 78.93   Mean   :56.36  \n Burkina Faso: 1   3rd Qu.:2000   3rd Qu.:103.30   3rd Qu.:60.00  \n Burundi     : 1   Max.   :2000   Max.   :143.30   Max.   :75.00  \n (Other)     :45                                                  \n   fertility       population             gdp               continent \n Min.   :1.990   Min.   :    81154   Min.   :2.019e+08   Africa  :51  \n 1st Qu.:4.150   1st Qu.:  2304687   1st Qu.:1.274e+09   Americas: 0  \n Median :5.550   Median :  8799165   Median :3.238e+09   Asia    : 0  \n Mean   :5.156   Mean   : 15659800   Mean   :1.155e+10   Europe  : 0  \n 3rd Qu.:5.960   3rd Qu.: 17391242   3rd Qu.:8.654e+09   Oceania : 0  \n Max.   :7.730   Max.   :122876723   Max.   :1.329e+11                \n                                                                      \n                       region  \n Eastern Africa           :16  \n Western Africa           :16  \n Middle Africa            : 8  \n Northern Africa          : 6  \n Southern Africa          : 5  \n Australia and New Zealand: 0  \n (Other)                  : 0  \n\n#plot \nplot(afri2000$infant_mortality,afri2000$life_expectancy, main=\"infant mortality VS life expectancy\", xlab=\"infant mortality\", ylab=\"life expectancy\", pch=19)\n\n\n\n#plot\nplot(afri2000$population,afri2000$life_expectancy, main=\"population size VS life expectancy\", xlab=\"population size\", ylab=\"life expectancy\", pch=19,log='x')\n\n\n\n\n\nfit1 <- lm(life_expectancy~infant_mortality,data=afri2000)\nsummary(fit1)\n\n\nCall:\nlm(formula = life_expectancy ~ infant_mortality, data = afri2000)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-22.6651  -3.7087   0.9914   4.0408   8.6817 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      71.29331    2.42611  29.386  < 2e-16 ***\ninfant_mortality -0.18916    0.02869  -6.594 2.83e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.221 on 49 degrees of freedom\nMultiple R-squared:  0.4701,    Adjusted R-squared:  0.4593 \nF-statistic: 43.48 on 1 and 49 DF,  p-value: 2.826e-08\n\nfit2 <- lm(life_expectancy~population,data=afri2000)\nsummary(fit2)\n\n\nCall:\nlm(formula = life_expectancy ~ population, data = afri2000)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-18.429  -4.602  -2.568   3.800  18.802 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 5.593e+01  1.468e+00  38.097   <2e-16 ***\npopulation  2.756e-08  5.459e-08   0.505    0.616    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.524 on 49 degrees of freedom\nMultiple R-squared:  0.005176,  Adjusted R-squared:  -0.01513 \nF-statistic: 0.2549 on 1 and 49 DF,  p-value: 0.6159\n\n\nHere we know infant mortality has statistically significant negative relationship with life-expectancy. But we don’t have enough statistical evidence about the relationship between population and life expectancy.\n————————————————————————————————————————–\nTHIS SECTION ADDED BY SHIWANI SAPKOTA\nI am interested on looking at infant mortality, life expectancy, fertility, and population variables for European countries in the year 2010 using gapminder data.\nDATA PROCESSING\n\n# Creating an object europedata containing only the European countries\neuropedata <- gapminder %>% filter(continent == \"Europe\")\n\n# Looking at the structure and summary of object (europedata)\nstr(europedata)\n\n'data.frame':   2223 obs. of  9 variables:\n $ country         : Factor w/ 185 levels \"Albania\",\"Algeria\",..: 1 9 15 16 21 25 42 45 46 54 ...\n $ year            : int  1960 1960 1960 1960 1960 1960 1960 1960 1960 1960 ...\n $ infant_mortality: num  115.4 37.3 NA 29.5 105 ...\n $ life_expectancy : num  62.9 68.8 71.6 69.6 62.6 ...\n $ fertility       : num  6.19 2.7 2.74 2.6 4.05 2.25 2.33 2.3 2.54 1.95 ...\n $ population      : num  1636054 7065525 8190027 9140563 3214520 ...\n $ gdp             : num  NA 5.24e+10 NA 6.82e+10 NA ...\n $ continent       : Factor w/ 5 levels \"Africa\",\"Americas\",..: 4 4 4 4 4 4 4 4 4 4 ...\n $ region          : Factor w/ 22 levels \"Australia and New Zealand\",..: 19 22 7 22 19 7 19 7 13 13 ...\n\nsummary(europedata)\n\n                   country          year      infant_mortality life_expectancy\n Albania               :  57   Min.   :1960   Min.   :  1.50   Min.   :60.85  \n Austria               :  57   1st Qu.:1974   1st Qu.:  5.80   1st Qu.:70.49  \n Belarus               :  57   Median :1988   Median : 11.25   Median :73.11  \n Belgium               :  57   Mean   :1988   Mean   : 15.33   Mean   :73.56  \n Bosnia and Herzegovina:  57   3rd Qu.:2002   3rd Qu.: 19.50   3rd Qu.:76.80  \n Bulgaria              :  57   Max.   :2016   Max.   :120.00   Max.   :83.30  \n (Other)               :1881                  NA's   :305                     \n   fertility       population             gdp               continent   \n Min.   :1.130   Min.   :   175520   Min.   :6.277e+08   Africa  :   0  \n 1st Qu.:1.510   1st Qu.:  3261643   1st Qu.:1.278e+10   Americas:   0  \n Median :1.870   Median :  7614832   Median :7.388e+10   Asia    :   0  \n Mean   :1.968   Mean   : 17891944   Mean   :2.295e+11   Europe  :2223  \n 3rd Qu.:2.232   3rd Qu.: 13400360   3rd Qu.:2.167e+11   Oceania :   0  \n Max.   :6.190   Max.   :148435811   Max.   :2.131e+12                  \n NA's   :39      NA's   :39          NA's   :789                        \n                       region   \n Southern Europe          :684  \n Eastern Europe           :570  \n Northern Europe          :570  \n Western Europe           :399  \n Australia and New Zealand:  0  \n Caribbean                :  0  \n (Other)                  :  0  \n\nglimpse(europedata)\n\nRows: 2,223\nColumns: 9\n$ country          <fct> \"Albania\", \"Austria\", \"Belarus\", \"Belgium\", \"Bosnia a…\n$ year             <int> 1960, 1960, 1960, 1960, 1960, 1960, 1960, 1960, 1960,…\n$ infant_mortality <dbl> 115.4, 37.3, NA, 29.5, 105.0, 49.0, 70.0, 22.0, 21.3,…\n$ life_expectancy  <dbl> 62.87, 68.75, 71.59, 69.59, 62.56, 69.22, 64.85, 70.5…\n$ fertility        <dbl> 6.19, 2.70, 2.74, 2.60, 4.05, 2.25, 2.33, 2.30, 2.54,…\n$ population       <dbl> 1636054, 7065525, 8190027, 9140563, 3214520, 7866472,…\n$ gdp              <dbl> NA, 52392699681, NA, 68236665814, NA, NA, NA, NA, 521…\n$ continent        <fct> Europe, Europe, Europe, Europe, Europe, Europe, Europ…\n$ region           <fct> Southern Europe, Western Europe, Eastern Europe, West…\n\n\n\n# Looking at the years having missing data for infant mortality in europedata\ninfantmort_yrs_europe <- europedata %>% \n                        filter(is.na(infant_mortality))\ntable(infantmort_yrs_europe$year)\n\n\n1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974 1975 \n   6   19   19   18   17   17   17   16   14   14    3   11   11   11   11   11 \n1976 1977 1978 1979 1980 1981 1982 1983 2016 \n  11   11   11   10    2    2    2    2   39 \n\n\n\n# Creating a new object named europedata_2010 by using only year 2010 data from europedata\neuropedata_2010 <- europedata %>%\n                   filter(year == 2010)\n\n# Looking at the structure and summary of object (europedata_2010)\nstr(europedata_2010)\n\n'data.frame':   39 obs. of  9 variables:\n $ country         : Factor w/ 185 levels \"Albania\",\"Algeria\",..: 1 9 15 16 21 25 42 45 46 54 ...\n $ year            : int  2010 2010 2010 2010 2010 2010 2010 2010 2010 2010 ...\n $ infant_mortality: num  14.8 3.6 4.7 3.6 6.4 11.2 4.6 3.4 3.3 3.6 ...\n $ life_expectancy : num  77.2 80.5 70.2 80.1 77.9 73.7 76.7 77.5 79.4 76.4 ...\n $ fertility       : num  1.74 1.44 1.46 1.84 1.24 1.49 1.47 1.5 1.88 1.63 ...\n $ population      : num  2901883 8391986 9492122 10929978 3835258 ...\n $ gdp             : num  6.14e+09 2.24e+11 2.60e+10 2.67e+11 8.21e+09 ...\n $ continent       : Factor w/ 5 levels \"Africa\",\"Americas\",..: 4 4 4 4 4 4 4 4 4 4 ...\n $ region          : Factor w/ 22 levels \"Australia and New Zealand\",..: 19 22 7 22 19 7 19 7 13 13 ...\n\nsummary(europedata_2010)\n\n                   country        year      infant_mortality life_expectancy\n Albania               : 1   Min.   :2010   Min.   : 1.900   Min.   :68.90  \n Austria               : 1   1st Qu.:2010   1st Qu.: 3.450   1st Qu.:75.00  \n Belarus               : 1   Median :2010   Median : 4.100   Median :79.40  \n Belgium               : 1   Mean   :2010   Mean   : 5.544   Mean   :77.73  \n Bosnia and Herzegovina: 1   3rd Qu.:2010   3rd Qu.: 6.500   3rd Qu.:80.90  \n Bulgaria              : 1   Max.   :2010   Max.   :14.800   Max.   :82.80  \n (Other)               :33                                                  \n   fertility       population             gdp               continent \n Min.   :1.240   Min.   :   318042   Min.   :1.405e+09   Africa  : 0  \n 1st Qu.:1.440   1st Qu.:  3479046   1st Qu.:1.437e+10   Americas: 0  \n Median :1.490   Median :  7830534   Median :5.653e+10   Asia    : 0  \n Mean   :1.587   Mean   : 18843145   Mean   :2.759e+11   Europe  :39  \n 3rd Qu.:1.770   3rd Qu.: 13904540   3rd Qu.:2.591e+11   Oceania : 0  \n Max.   :2.120   Max.   :143158099   Max.   :2.069e+12                \n                                                                      \n                       region  \n Southern Europe          :12  \n Eastern Europe           :10  \n Northern Europe          :10  \n Western Europe           : 7  \n Australia and New Zealand: 0  \n Caribbean                : 0  \n (Other)                  : 0  \n\nglimpse(europedata_2010)\n\nRows: 39\nColumns: 9\n$ country          <fct> \"Albania\", \"Austria\", \"Belarus\", \"Belgium\", \"Bosnia a…\n$ year             <int> 2010, 2010, 2010, 2010, 2010, 2010, 2010, 2010, 2010,…\n$ infant_mortality <dbl> 14.8, 3.6, 4.7, 3.6, 6.4, 11.2, 4.6, 3.4, 3.3, 3.6, 2…\n$ life_expectancy  <dbl> 77.2, 80.5, 70.2, 80.1, 77.9, 73.7, 76.7, 77.5, 79.4,…\n$ fertility        <dbl> 1.74, 1.44, 1.46, 1.84, 1.24, 1.49, 1.47, 1.50, 1.88,…\n$ population       <dbl> 2901883, 8391986, 9492122, 10929978, 3835258, 7407297…\n$ gdp              <dbl> 6.137564e+09, 2.239541e+11, 2.600213e+10, 2.671431e+1…\n$ continent        <fct> Europe, Europe, Europe, Europe, Europe, Europe, Europ…\n$ region           <fct> Southern Europe, Western Europe, Eastern Europe, West…\n\n\n\n# Looking at the top 5 European countries having highest infant mortality for the year 2010\neurope_infantmort <- europedata_2010 %>% select (country, infant_mortality) %>%\narrange(desc(`infant_mortality`))\neurope2010_infantmort <- head(europe_infantmort, 5)\neurope2010_infantmort\n\n   country infant_mortality\n1  Albania             14.8\n2  Moldova             14.7\n3  Romania             12.1\n4 Bulgaria             11.2\n5   Russia             10.3\n\n# Looking at the top 5 European countries having highest life expectancy for the year 2010\neurope_lifeexpect <- europedata_2010 %>% select (country, life_expectancy) %>%\narrange(desc(`life_expectancy`))\neurope2010_lifeexpect <- head(europe_lifeexpect, 5)\neurope2010_lifeexpect\n\n      country life_expectancy\n1     Iceland            82.8\n2 Switzerland            82.3\n3       Italy            81.9\n4       Spain            81.8\n5      Sweden            81.6\n\n# Looking at the top 5 European countries having largest population size for the year 2010\neurope_pop <- europedata_2010 %>% select (country, population) %>%\narrange(desc(`population`))\neurope2010_pop <- head(europe_pop, 5)\neurope2010_pop\n\n         country population\n1         Russia  143158099\n2        Germany   80435307\n3         France   62961136\n4 United Kingdom   62716684\n5          Italy   59588007\n\n\nDATA VISUALIZATION\n\n# Creating the object country to sort the 5 European countries having the highest infant mortality in the year 2010\neurope2010_infantmort <- europe2010_infantmort %>%\nmutate(country = as_factor(country),\ncountry <- fct_reorder(country, infant_mortality))\n\n# Plotting the horizontal barplot for visualizing top 5 European countries with the highest infant mortality in 2010\nggplot(data = europe2010_infantmort, aes(x = country, y = `infant_mortality`)) +\ngeom_bar(stat = \"identity\", width = 0.75, color = \"blue\", fill = \"steelblue\") +\ncoord_flip() +\nlabs(title = \"Top 5 European countries with the highest infant mortality in 2010\",\nx = \"Country\", y = \"Infant Mortality\") +\ntheme_classic() +\ntheme(axis.text = element_text(face=\"bold\"), plot.title = element_text(hjust = 0.5, size = 14),\naxis.title = element_text(size = 14))\n\n\n\n\n\n# Plotting fertility as a function of infant mortality in the year 2010 for European countries\nggplot(data = europedata_2010,\n       (aes(x = infant_mortality, y = fertility))) +\n  theme_classic() +\n  geom_point(size = 1.0) +\n  labs(title = \"Fertility as a function of infant mortality in the year 2010 for European countries\",\n       x = \"Infant Mortality\", y = \"Fertility\") +\n  theme(axis.text = element_text(face = \"bold\"), plot.title = element_text(hjust = 0.5, size = 14),\n        axis.title = element_text(size = 14))\n\n\n\n\n\n# Plotting life expectancy as a function of population size in the year 2010 for European countries\nggplot(data = europedata_2010,\n       (aes(x = population, y = life_expectancy))) +\n  theme_classic() +\n  geom_point(size = 1.0) +\n  scale_x_continuous(trans = 'log10') +\n  labs(title = \"Life expectancy as a function of population size in the year 2010 for European countries\", \n       x = \"Population (In Logscale)\", y = \"Life Expectancy (In Years)\") +\n  theme(axis.text = element_text(face = \"bold\"), plot.title =   element_text(hjust = 0.5, size = 14),\n        axis.title = element_text(size = 14))\n\n\n\n\nFITTING MODEL\n\n# Using lm function to fit linear regression model using fertility as the outcome and infant mortality as the predictor for the year 2010\nfit3 <- lm(fertility ~ infant_mortality, data = europedata_2010)\n# Tabulating the output fit3 from lm using broom package\nbroom::tidy(fit3)\n\n# A tibble: 2 × 5\n  term             estimate std.error statistic  p.value\n  <chr>               <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)        1.71      0.0691     24.8  1.25e-24\n2 infant_mortality  -0.0224    0.0107     -2.10 4.29e- 2\n\n# Using lm function to fit linear regression model using life expectancy as the outcome and population size as the predictor for the year 2010\nfit4 <- lm(life_expectancy ~ population, data = europedata_2010)\n# Tabulating the output fit4 from lm using broom package\nbroom::tidy(fit4)\n\n# A tibble: 2 × 5\n  term             estimate    std.error statistic  p.value\n  <chr>               <dbl>        <dbl>     <dbl>    <dbl>\n1 (Intercept) 78.1          0.730          107.    1.05e-47\n2 population  -0.0000000203 0.0000000213    -0.956 3.45e- 1\n\n\nCONCLUSION\nBased on the p-values for each fit, we found somewhat statistically significant negative correlation between infant mortality and fertility in the year 2010 for European countries (p-value: 0.0429) while we found no statistically significant correlation between population size and life expectancy in the year 2010 for European countries (p-value: 0.345 )."
  },
  {
    "objectID": "dataanalysis_exercise.html",
    "href": "dataanalysis_exercise.html",
    "title": "dataanalysis_exercise",
    "section": "",
    "text": "The data was found at https://data.cdc.gov/NCHS/Weekly-Counts-of-Deaths-by-Jurisdiction-and-Age/y5bj-9g5w\nThis data include 11 variables. This data set describes a time series data for each state by age.\n\nlibrary(ggplot2)\nlibrary(here)\n\nhere() starts at E:/uga course/bios8060e/res1/yaolu-MADA-portfolio\n\ndata1 <- read.csv(\"mod4/rawdata/Weekly_Counts_of_Deaths_by_Jurisdiction_and_Age.csv\")\n\np <- ggplot(data = data1[which(data1$Jurisdiction==\"Georgia\"&data1$Type=='Predicted (weighted)'),], aes(x = Week, y = Number.of.Deaths, group = Age.Group,color=Age.Group))\np + geom_line()+ggtitle(\"number of death(weighted) in GA\") +  xlab(\"week\") + ylab(\"death\")\n\n\n\n\nHere we can see that most death happened at aged people. Few young people die. Then we check the ‘Week’ variables. We can see that The week is the number of week in each year. Then we want to see a time series week.\n\n#redefine the week variable\ntable(data1$Year[which(data1$Week==53)])\n\n\n2020 \n 592 \n\ntable(data1$Year[which(data1$Week==52)])\n\n\n2015 2016 2017 2018 2019 2020 2021 2022 \n 582  598  590  584  588  596  608  561 \n\ndata1$newweek <- NA\ndata1$newweek[which(data1$Year==2015)] <- data1$Week[which(data1$Year==2015)]\ndata1$newweek[which(data1$Year==2016)] <- data1$Week[which(data1$Year==2016)]+52\ndata1$newweek[which(data1$Year==2017)] <- data1$Week[which(data1$Year==2017)]+52*2\ndata1$newweek[which(data1$Year==2018)] <- data1$Week[which(data1$Year==2018)]+52*3\ndata1$newweek[which(data1$Year==2019)] <- data1$Week[which(data1$Year==2019)]+52*4\ndata1$newweek[which(data1$Year==2020)] <- data1$Week[which(data1$Year==2020)]+52*5\ndata1$newweek[which(data1$Year==2021)] <- data1$Week[which(data1$Year==2021)]+52*6+1\ndata1$newweek[which(data1$Year==2022)] <- data1$Week[which(data1$Year==2022)]+52*7+1\n\n\np <- ggplot(data = data1[which(data1$Jurisdiction==\"Georgia\"&data1$Type=='Predicted (weighted)'),], aes(x = newweek, y = Number.of.Deaths, group = Age.Group,color=Age.Group))\np + geom_line()+ggtitle(\"number of death(weighted) in GA\") +  xlab(\"week\") + ylab(\"death\")\n\nWarning: Removed 16 row(s) containing missing values (geom_path).\n\n\n\n\n\nWe can see that there is a peak at around 350 weeks. Here we can see that most death happened at aged people. Few young people die.\nWe can apply time series analysis. Such as using ACF, PACF to find best ARIMA model.\n\nsaveRDS(data1, file = \"mod4/processdata/cleandata.rds\")\n\n\ntable(data1$Age.Group)\n\n\n       25-44 years        45-64 years        65-74 years        75-84 years \n             37940              45293              45287              45304 \n85 years and older     Under 25 years \n             45280              29494 \n\ndata1$Age.Group[which(data1$Age.Group=='Under 25 years')] <- '24 or younger'\n\n\nboxplot(Number.of.Deaths~Age.Group,data=data1[which(data1$Jurisdiction==\"Georgia\"&data1$Type=='Predicted (weighted)'),], main=\"number of deaths in GA\",        xlab=\"age\", ylab=\"deaths\")\n\n\n\n\n\n—————————————\nTHIS SECTION ADDED BY IRENE CAVROS\n—————————————\n\nLoad packages\n\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(readr)\nlibrary(tidyverse)\n\n── Attaching packages\n───────────────────────────────────────\ntidyverse 1.3.2 ──\n\n\n✔ tibble  3.1.8     ✔ purrr   0.3.4\n✔ tidyr   1.2.0     ✔ forcats 0.5.1\n\n\nWarning: package 'tibble' was built under R version 4.2.2\n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\n\n\n\nRead and check clean RDS file\n\ndeathdata_clean_INC <- readRDS(\"mod4/processdata/cleandata.rds\")\n\nstr(deathdata_clean_INC)\n\n'data.frame':   248598 obs. of  12 variables:\n $ Jurisdiction      : chr  \"Alabama\" \"Alabama\" \"Alabama\" \"Alabama\" ...\n $ Week.Ending.Date  : chr  \"01/10/2015\" \"01/17/2015\" \"01/24/2015\" \"01/31/2015\" ...\n $ State.Abbreviation: chr  \"AL\" \"AL\" \"AL\" \"AL\" ...\n $ Year              : int  2015 2015 2015 2015 2015 2015 2015 2015 2015 2015 ...\n $ Week              : int  1 2 3 4 5 6 7 8 9 10 ...\n $ Age.Group         : chr  \"25-44 years\" \"25-44 years\" \"25-44 years\" \"25-44 years\" ...\n $ Number.of.Deaths  : int  67 49 55 59 47 59 41 47 60 57 ...\n $ Time.Period       : chr  \"2015-2019\" \"2015-2019\" \"2015-2019\" \"2015-2019\" ...\n $ Type              : chr  \"Predicted (weighted)\" \"Predicted (weighted)\" \"Predicted (weighted)\" \"Predicted (weighted)\" ...\n $ Suppress          : chr  \"\" \"\" \"\" \"\" ...\n $ Note              : chr  \"\" \"\" \"\" \"\" ...\n $ newweek           : num  1 2 3 4 5 6 7 8 9 10 ...\n\nhead(deathdata_clean_INC)\n\n  Jurisdiction Week.Ending.Date State.Abbreviation Year Week   Age.Group\n1      Alabama       01/10/2015                 AL 2015    1 25-44 years\n2      Alabama       01/17/2015                 AL 2015    2 25-44 years\n3      Alabama       01/24/2015                 AL 2015    3 25-44 years\n4      Alabama       01/31/2015                 AL 2015    4 25-44 years\n5      Alabama       02/07/2015                 AL 2015    5 25-44 years\n6      Alabama       02/14/2015                 AL 2015    6 25-44 years\n  Number.of.Deaths Time.Period                 Type Suppress Note newweek\n1               67   2015-2019 Predicted (weighted)                     1\n2               49   2015-2019 Predicted (weighted)                     2\n3               55   2015-2019 Predicted (weighted)                     3\n4               59   2015-2019 Predicted (weighted)                     4\n5               47   2015-2019 Predicted (weighted)                     5\n6               59   2015-2019 Predicted (weighted)                     6\n\n\n\nIt looks like there are observations here with state abbreviation ‘US.’ I am going to remove these since it is likely an aggregate of all states and not an actual state in itself. But before I do this, I will look at deaths in the US by year.\n\n\n\nLook at US only data\n\nUS <- deathdata_clean_INC %>%\n  filter(State.Abbreviation %in% \"US\")\n\n\n\nPlot of US data by year\n\nggplot (US, aes(x=Year, y=Number.of.Deaths)) + \n  geom_bar(stat = 'identity') + \n  labs(x = \"Year\", y = \"Deaths\", \n       title = \"Deaths in the US by year\")\n\n\n\n\n\n\nNew smaller dataset only looking at only 4 variables,\n\ndeaths_subset_INC <- deathdata_clean_INC %>%\n    select(State.Abbreviation, Year, Age.Group, Number.of.Deaths)\n\n\n\nRemove observations with state abbreviation US\n\nstate_deaths_INC <- deaths_subset_INC %>%\n    filter(!State.Abbreviation %in% c('US'))\n\n\n\nSubset for year 2015\n\ndeaths_2015_INC <- state_deaths_INC %>% \n    filter(Year==2015)\n\n\n\nSubset for year 2016\n\ndeaths_2016_INC <- state_deaths_INC %>% \n    filter(Year==2016)\n\n\n\nSubset for year 2017\n\ndeaths_2017_INC <- state_deaths_INC %>% \n    filter(Year==2017)\n\n\n\nSubset for year 2018\n\ndeaths_2018_INC <- state_deaths_INC %>% \n    filter(Year==2018)\n\n\n\nSubset for year 2019\n\ndeaths_2019_INC <- state_deaths_INC %>% \n    filter(Year==2019)\n\n\n\nBar graph of deaths by state in the year 2015\n\nggplot (state_deaths_INC, aes(x=State.Abbreviation, y=Number.of.Deaths)) + \n  geom_bar(stat = 'identity') + \n  coord_flip() +\n  labs(x = \"State\", y = \"Deaths\", \n       title = \"Deaths by State in 2015\")\n\nWarning: Removed 32 rows containing missing values (position_stack)."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "My website and data analysis portfolio",
    "section": "",
    "text": "Happy new year\n\nAnd happy new semester\nWelcome to my website and data analysis portfolio.\n\nPlease use the Menu Bar above to look around.\nHave fun!"
  },
  {
    "objectID": "tidytuesday_exercise.html",
    "href": "tidytuesday_exercise.html",
    "title": "Tidy Tuesday Exercise",
    "section": "",
    "text": "# Get the Data\n\n# Read in with tidytuesdayR package \n# Install from CRAN via: install.packages(\"tidytuesdayR\")\n# This loads the readme and all the datasets for the week of interest\n\n# Either ISO-8601 date or year/week works!\n\nlibrary('tidytuesdayR')\n\nWarning: package 'tidytuesdayR' was built under R version 4.2.2\n\ntuesdata <- tidytuesdayR::tt_load('2023-02-14')\n\n--- Compiling #TidyTuesday Information for 2023-02-14 ----\n\n\n--- There is 1 file available ---\n\n\n--- Starting Download ---\n\n\n\n    Downloading file 1 of 1: `age_gaps.csv`\n\n\n--- Download complete ---\n\ntuesdata <- tidytuesdayR::tt_load(2023, week = 7)\n\n--- Compiling #TidyTuesday Information for 2023-02-14 ----\n\n\n--- There is 1 file available ---\n\n\n--- Starting Download ---\n\n\n\n    Downloading file 1 of 1: `age_gaps.csv`\n\n\n--- Download complete ---\n\nage_gaps <- tuesdata$age_gaps\n\nFirst we want to have a look at if there are some directors who generate multiple movies.\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(ggplot2)\nlibrary(forcats)\nresults <- age_gaps %>%\n  group_by(director) %>%\n  summarize(count = n_distinct(movie_name))\n\nresults1 <- results[order(-results$count),]\n\nbarplot(results1$count[1:3],names.arg=results1$director[1:3])\n\n\n\n\nHere we can see that, base on the number of movies, Woody Allen, Martin Scorsese and Steven Spielberg are the top 3 directors.\nHere we focus on thess three directors to explore our data.\nWe want to have a look at the age distribution among three directors.\n\nlibrary(tidyr)\ndf <- age_gaps[which(age_gaps$director %in% c('Woody Allen','Martin Scorsese','Steven Spielberg')),]\n\ndf1 <- gather(df,key='actorgroup',value='age',12:13) \n\ndf1 %>% \n    mutate(actorgroup=if_else(actorgroup=='actor_1_age','older','younger')) %>%\n    ggplot( aes(x=director, y=age,fill=actorgroup)) + \n    geom_boxplot()+ggtitle('age group by director')\n\n\n\n\nHere we can see that, director Woody Allen like to choose aged older actor. From here, looks like age difference is biggest. So we would like to have a look at the difference.\n\ndf %>%\n    ggplot( aes(x=director, y=age_difference)) + \n    geom_boxplot()\n\n\n\n\nHard to say if the age_difference are different among these directors. So, I want to do some stitistical test.\n\nlibrary(ggpubr)\nggboxplot(df,x = 'director', y = 'age_difference',\n          palette = \"jco\",exact=FALSE)+ \n  stat_compare_means()+ggtitle('age difference')\n\n\n\n\nSo, they are not all same. Then I can try tukeytest.\n\nTukeyHSD(aov(lm(df$age_difference~df$director)))\n\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = lm(df$age_difference ~ df$director))\n\n$`df$director`\n                                     diff         lwr      upr     p adj\nSteven Spielberg-Martin Scorsese 2.576923 -8.25508953 13.40894 0.8320509\nWoody Allen-Martin Scorsese      9.226923  0.05232155 18.40152 0.0484482\nWoody Allen-Steven Spielberg     6.650000 -3.32384339 16.62384 0.2479557\n\n\nSuggestion for script writer. Woody Allen prefer large age_difference than Martin Scorsese. So, if you have a script with large age_diffenence, go to talk to Woody Allen rather than Martin Scorsese. Woody Allen will have a higher chance to accept your script.\n\ndf2 <- filter(df1,actorgroup=='actor_1_age')\n  TukeyHSD(aov(lm(df2$age~df2$director)))\n\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = lm(df2$age ~ df2$director))\n\n$`df2$director`\n                                     diff        lwr      upr     p adj\nSteven Spielberg-Martin Scorsese 1.084615 -11.009175 13.17841 0.9740921\nWoody Allen-Martin Scorsese      8.784615  -1.458699 19.02793 0.1053042\nWoody Allen-Steven Spielberg     7.700000  -3.435656 18.83566 0.2241361\n\ndf3 <- filter(df1,actorgroup=='actor_2_age')\nTukeyHSD(aov(lm(df3$age~df3$director)))\n\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = lm(df3$age ~ df3$director))\n\n$`df3$director`\n                                       diff       lwr      upr     p adj\nSteven Spielberg-Martin Scorsese -1.4923077 -8.702591 5.717975 0.8699312\nWoody Allen-Martin Scorsese      -0.4423077 -6.549342 5.664727 0.9830222\nWoody Allen-Steven Spielberg      1.0500000 -5.589046 7.689046 0.9217317\n\n\nHere we can see that, there is no difference for actor age. No matter how old is the actor. You probably have same chance to be accepted by either these three directors. Don’t worry your age, you have same chance as older or younger actor."
  },
  {
    "objectID": "visualization_exercise.html",
    "href": "visualization_exercise.html",
    "title": "Visualization Exercise",
    "section": "",
    "text": "Placeholder file for the future visualization exercise.\nsource https://fivethirtyeight.com/features/how-every-nfl-teams-fans-lean-politically/\ndata https://github.com/fivethirtyeight/data/tree/master/nfl-fandom\n\nlibrary(naniar)\nlibrary(tibble)\n\nWarning: package 'tibble' was built under R version 4.2.2\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(cowplot)\nlibrary(gridExtra)\n\n\nAttaching package: 'gridExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    combine\n\nlibrary(ggplot2)\n\ndata1 <- read.csv(\"mod5/NFL_fandom_data-google_trends.csv\",header = TRUE,skip=1)\n\na <- miss_var_summary(data1)\nglimpse(data1)\n\nRows: 207\nColumns: 9\n$ DMA              <chr> \"Abilene-Sweetwater TX\", \"Albany GA\", \"Albany-Schenec…\n$ NFL              <chr> \"45%\", \"32%\", \"40%\", \"53%\", \"42%\", \"28%\", \"47%\", \"36%…\n$ NBA              <chr> \"21%\", \"30%\", \"20%\", \"21%\", \"28%\", \"13%\", \"22%\", \"28%…\n$ MLB              <chr> \"14%\", \"9%\", \"20%\", \"11%\", \"9%\", \"21%\", \"12%\", \"10%\",…\n$ NHL              <chr> \"2%\", \"1%\", \"8%\", \"3%\", \"1%\", \"12%\", \"2%\", \"3%\", \"3%\"…\n$ NASCAR           <chr> \"4%\", \"8%\", \"6%\", \"3%\", \"5%\", \"10%\", \"5%\", \"5%\", \"8%\"…\n$ CBB              <chr> \"3%\", \"3%\", \"3%\", \"4%\", \"3%\", \"7%\", \"3%\", \"5%\", \"4%\",…\n$ CFB              <chr> \"11%\", \"17%\", \"4%\", \"6%\", \"12%\", \"9%\", \"10%\", \"14%\", …\n$ Trump.2016.Vote. <chr> \"79.13%\", \"59.12%\", \"44.11%\", \"39.58%\", \"69.64%\", \"63…\n\ndata2 <-data1\n\ndata2[,1] <- data1[,1]\ndata2[,2:9] <- data.frame(sapply(data1[,2:9], function(x) as.numeric(gsub(\"%\", \"\", x))))\n\ncolnames(data2)[9] =\"Trumpvote\"\n\nglimpse(data2)\n\nRows: 207\nColumns: 9\n$ DMA       <chr> \"Abilene-Sweetwater TX\", \"Albany GA\", \"Albany-Schenectady-Tr…\n$ NFL       <dbl> 45, 32, 40, 53, 42, 28, 47, 36, 39, 40, 48, 45, 39, 40, 45, …\n$ NBA       <dbl> 21, 30, 20, 21, 28, 13, 22, 28, 26, 29, 26, 20, 20, 29, 27, …\n$ MLB       <dbl> 14, 9, 20, 11, 9, 21, 12, 10, 8, 11, 14, 20, 19, 8, 12, 13, …\n$ NHL       <dbl> 2, 1, 8, 3, 1, 12, 2, 3, 3, 3, 3, 5, 9, 2, 1, 4, 5, 2, 9, 2,…\n$ NASCAR    <dbl> 4, 8, 6, 3, 5, 10, 5, 5, 8, 3, 4, 3, 8, 3, 4, 4, 5, 6, 7, 6,…\n$ CBB       <dbl> 3, 3, 3, 4, 3, 7, 3, 5, 4, 3, 1, 3, 2, 3, 2, 3, 4, 3, 3, 6, …\n$ CFB       <dbl> 11, 17, 4, 6, 12, 9, 10, 14, 13, 11, 3, 4, 3, 15, 9, 13, 7, …\n$ Trumpvote <dbl> 79.13, 59.12, 44.11, 39.58, 69.64, 63.61, 77.54, 47.58, 52.7…\n\np1 <- ggplot(data = data2, mapping = aes(x = Trumpvote, y = NBA))+geom_point()+xlim(20,80)+ylim(0,50)+ggtitle(\"NBA\")+geom_smooth(method = \"lm\")\n\n\n\np2 <- ggplot(data = data2, mapping = aes(x = Trumpvote, y = MLB))+geom_point()+xlim(20,80)+ylim(0,50)+ggtitle(\"MLB\")+geom_smooth(method = \"lm\")\n\np3 <- ggplot(data = data2, mapping = aes(x = Trumpvote, y = NHL))+geom_point()+xlim(20,80)+ylim(0,50)+ggtitle(\"NHL\")+geom_smooth(method = \"lm\")\n\np4 <- ggplot(data = data2, mapping = aes(x = Trumpvote, y = NFL))+geom_point()+xlim(20,80)+ylim(0,50)+ggtitle(\"NFL\")+geom_smooth(method = \"lm\")\n\np5 <- ggplot(data = data2, mapping = aes(x = Trumpvote, y = CBB))+geom_point()+xlim(20,80)+ylim(0,50)+ggtitle(\"CBB\")+geom_smooth(method = \"lm\")\n\np6 <- ggplot(data = data2, mapping = aes(x = Trumpvote, y = NASCAR))+geom_point()+xlim(20,80)+ylim(0,50)+ggtitle(\"NASCAR\")+geom_smooth(method = \"lm\")\n\np7 <- ggplot(data = data2, mapping = aes(x = Trumpvote, y = CFB))+geom_point()+xlim(20,80)+ylim(0,50)+ggtitle(\"CFB\")+geom_smooth(method = \"lm\")\n\n\ngrid.arrange(p1,p2,p3,p4,p5,p6,p7, ncol=7, nrow =1)\n\n`geom_smooth()` using formula 'y ~ x'\n\n\nWarning: Removed 1 rows containing non-finite values (stat_smooth).\n\n\nWarning: Removed 1 rows containing missing values (geom_point).\n\n\n`geom_smooth()` using formula 'y ~ x'\n\n\nWarning: Removed 1 rows containing non-finite values (stat_smooth).\nRemoved 1 rows containing missing values (geom_point).\n\n\n`geom_smooth()` using formula 'y ~ x'\n\n\nWarning: Removed 1 rows containing non-finite values (stat_smooth).\nRemoved 1 rows containing missing values (geom_point).\n\n\n`geom_smooth()` using formula 'y ~ x'\n\n\nWarning: Removed 12 rows containing non-finite values (stat_smooth).\n\n\nWarning: Removed 12 rows containing missing values (geom_point).\n\n\n`geom_smooth()` using formula 'y ~ x'\n\n\nWarning: Removed 1 rows containing non-finite values (stat_smooth).\n\n\nWarning: Removed 1 rows containing missing values (geom_point).\n\n\n`geom_smooth()` using formula 'y ~ x'\n\n\nWarning: Removed 1 rows containing non-finite values (stat_smooth).\nRemoved 1 rows containing missing values (geom_point).\n\n\n`geom_smooth()` using formula 'y ~ x'\n\n\nWarning: Removed 1 rows containing non-finite values (stat_smooth).\nRemoved 1 rows containing missing values (geom_point).\n\n\n\n\n\nFirst plot is finished. And second plot include a map which I am not familiar with now. Maybe I will learn it next time.\n\ndata3 <- read.csv(\"mod5/NFL_fandom_data-surveymonkey.csv\",header = TRUE,skip=1)\n\nInitial data is not good to plot. So we need to do data cleaning and generate a new data frame.\n\n#seems wrong,just leave it here in case I need to come back\ndata4 <- data3 %>% select(c(1,21))\n\ndata4[34:66,] <- data3 %>% select(c(1,22))\n\ndata4[67:99,] <- data3 %>% select(c(1,23))\n\ndata4[,3] <- rep(c('GOP','DEM','IND'),each=33)\n\ncolnames(data4)[2:3] =c(\"percent\",'partisan')\n\n ggplot(data4, aes(x = Team, y = percent))+\n  geom_col(aes(fill = partisan))+ coord_flip()\n\n\n\n\nThen rank by difference.\n\ndata5 <- data3 %>% select(c(1,21:23))\ncolnames(data5)[2:4] <- c('gop','dem','ind')\nglimpse(data5)\n\nRows: 33\nColumns: 4\n$ Team <chr> \"Arizona Cardinals\", \"Atlanta Falcons\", \"Baltimore Ravens\", \"Buff…\n$ gop  <chr> \"26%\", \"29%\", \"19%\", \"26%\", \"30%\", \"22%\", \"35%\", \"28%\", \"32%\", \"2…\n$ dem  <chr> \"26%\", \"31%\", \"37%\", \"24%\", \"31%\", \"33%\", \"35%\", \"32%\", \"29%\", \"3…\n$ ind  <chr> \"48%\", \"40%\", \"43%\", \"50%\", \"39%\", \"45%\", \"30%\", \"40%\", \"39%\", \"3…\n\n data5[,2:4] <- data.frame(sapply(data5[,2:4], function(x) as.numeric(gsub(\"%\", \"\", x))))\n \n glimpse(data5)\n\nRows: 33\nColumns: 4\n$ Team <chr> \"Arizona Cardinals\", \"Atlanta Falcons\", \"Baltimore Ravens\", \"Buff…\n$ gop  <dbl> 26, 29, 19, 26, 30, 22, 35, 28, 32, 29, 18, 24, 31, 25, 29, 28, 2…\n$ dem  <dbl> 26, 31, 37, 24, 31, 33, 35, 32, 29, 32, 38, 33, 26, 30, 27, 28, 3…\n$ ind  <dbl> 48, 40, 43, 50, 39, 45, 30, 40, 39, 39, 44, 44, 44, 44, 44, 44, 4…\n\n data5$dif <- data5$dem-data5$gop\ndata5 <- data5[order(-data5$dif),]\ndata5$rank <- 1:33\ndata5 <- data5[order(data5$Team),]\n\n\ndata4 <- data4[order(data4$Team),]\ndata4$rank <- rep(data5$rank,each=3)\n\ndata6 <- data4[order(data4$rank),]\n\nlevel <- c('GOP','IND','DEM')\n\n\n\n  data6[,2] <- data.frame(sapply(data6[,2], function(x) as.numeric(gsub(\"%\", \"\", x))))\n  \n   ggplot(data6, aes(x = reorder(Team,-rank), y = percent))+\n  geom_col(aes(fill = factor(partisan,levels=level)))+ coord_flip()"
  }
]